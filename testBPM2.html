<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="test2.css" rel="stylesheet" type="text/css" media="all">
    <title>Network-Speed-Based Metronome</title>
</head>
<body>
    <img src="img/piano_A.png" alt="">
    <audio id="metronome" src="Metronom.mp3"></audio>

    <script>
        // ネットワーク速度を取得する関数
        async function getNetworkSpeed() {
            const startTime = Date.now();
            await fetch('https://example.com/dummy-file.jpg'); // 例: 1MBのダミーファイル
            const endTime = Date.now();

            const duration = (endTime - startTime) / 1000; // 秒
            const fileSizeInBits = 1000000 * 8; // 1MB（8ビット）を想定
            const speedBps = fileSizeInBits / duration;
            return speedBps / 1000000; // Mbps単位
        }

        // リダイレクト間隔を設定し、音を再生後に次のページへ移動
        async function setRedirect() {
            const speed = await getNetworkSpeed();
            const baseInterval = 2000; // 基本のリダイレクト間隔（ミリ秒）
            const interval = Math.max(baseInterval - (speed * 100), 500); // 速いほど短く、遅いほど長く
            const audio = document.getElementById("metronome");

            // 音声再生
            audio.currentTime = 0; // 音をリセット
            audio.play();

            // 音の再生後、指定の間隔でリダイレクト
            setTimeout(() => {
                window.location.href = "index.html";
            }, interval);
        }

        setRedirect(); // 関数の実行
    </script>
</body>
</html>
